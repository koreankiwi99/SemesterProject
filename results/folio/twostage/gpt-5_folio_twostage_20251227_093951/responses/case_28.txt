======================================================================
STAGE 1: TRANSLATION
======================================================================

--- Iteration 1 ---

<lean>
axiom obj : Type

axiom Alien : obj → Prop
axiom Extraterrestrial : obj → Prop
axiom Human : obj → Prop
axiom FromEarth : obj → Prop
axiom FromMars : obj → Prop
axiom HighlyIntelligent : obj → Prop

axiom Marvin : obj

-- Premises
axiom A1 : ∀ x : obj, Alien x → Extraterrestrial x
axiom A2 : ∀ x : obj, FromMars x → Alien x
axiom A3 : ∀ x : obj, Extraterrestrial x → ¬ Human x
axiom A4 : ∀ x : obj, HighlyIntelligent x ∧ FromEarth x → Human x
axiom A5 : HighlyIntelligent Marvin
axiom A6 : (FromEarth Marvin ∧ FromMars Marvin) ∨ (¬ FromEarth Marvin ∧ ¬ FromMars Marvin)
axiom A7 : ¬ FromEarth Marvin → Extraterrestrial Marvin

-- Conclusion to formalize
theorem goal : ¬ Human Marvin ∧ ¬ FromMars Marvin := sorry
</lean>


======================================================================
STAGE 2: PROVING
======================================================================

--- Iteration 1 ---

<lean>
axiom obj : Type

axiom Alien : obj → Prop
axiom Extraterrestrial : obj → Prop
axiom Human : obj → Prop
axiom FromEarth : obj → Prop
axiom FromMars : obj → Prop
axiom HighlyIntelligent : obj → Prop

axiom Marvin : obj

-- Premises
axiom A1 : ∀ x : obj, Alien x → Extraterrestrial x
axiom A2 : ∀ x : obj, FromMars x → Alien x
axiom A3 : ∀ x : obj, Extraterrestrial x → ¬ Human x
axiom A4 : ∀ x : obj, HighlyIntelligent x ∧ FromEarth x → Human x
axiom A5 : HighlyIntelligent Marvin
axiom A6 : (FromEarth Marvin ∧ FromMars Marvin) ∨ (¬ FromEarth Marvin ∧ ¬ FromMars Marvin)
axiom A7 : ¬ FromEarth Marvin → Extraterrestrial Marvin

-- Conclusion to formalize
theorem goal : ¬ Human Marvin ∧ ¬ FromMars Marvin := by
  cases A6 with
  | inl h =>
      apply And.intro
      ·
        have fm : FromMars Marvin := And.right h
        have alien : Alien Marvin := A2 Marvin fm
        have ext : Extraterrestrial Marvin := A1 Marvin alien
        exact A3 Marvin ext
      ·
        intro fm
        have fe : FromEarth Marvin := And.left h
        have alien : Alien Marvin := A2 Marvin fm
        have ext : Extraterrestrial Marvin := A1 Marvin alien
        have notH : ¬ Human Marvin := A3 Marvin ext
        have hH : Human Marvin := A4 Marvin (And.intro A5 fe)
        exact notH hH
  | inr h =>
      apply And.intro
      ·
        have nfe : ¬ FromEarth Marvin := And.left h
        have ext : Extraterrestrial Marvin := A7 nfe
        exact A3 Marvin ext
      ·
        exact And.right h
</lean>

ANSWER: True
